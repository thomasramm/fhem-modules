"use strict";!function(t){t.fn.famultibutton=function(e){function w(){a=!0,n.children("#bg").css("color",v.onBackgroundColor),n.children("#fg").css("color",v.onColor),n.addClass("active"),i.trigger("setOn")}function $(){a=!1,n.children("#bg").css("color",v.offBackgroundColor),n.children("#fg").css("color",v.offColor),n.removeClass("active"),i.trigger("setOff")}function y(){a&&(a=!1,t("<div />").animate({width:100},{duration:700,easing:"swing",step:function(t,e){var i=(t-e.start)/(e.end-e.start);n.children("#bg").css("color",x(v.onBackgroundColor,v.offBackgroundColor,i)),n.children("#fg").css("color",x(v.onColor,v.offColor,i))}}))}function S(t){var e=t.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return e&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):t}function x(t,e,i){t=S(t).replace(/^\s*#|\s*$/g,""),e=S(e).replace(/^\s*#|\s*$/g,""),3==t.length&&(t=t.replace(/(.)/g,"$1$1")),3==e.length&&(e=e.replace(/(.)/g,"$1$1"));var n=parseInt(t.substr(0,2),16),a=parseInt(t.substr(2,2),16),o=parseInt(t.substr(4,2),16),r=parseInt(e.substr(0,2),16),s=parseInt(e.substr(2,2),16),l=parseInt(e.substr(4,2),16),f=r-n,u=s-a,c=l-o;return f=(f*i+n).toString(16).split(".")[0],u=(u*i+a).toString(16).split(".")[0],c=(c*i+o).toString(16).split(".")[0],1==f.length&&(f="0"+f),1==u.length&&(u="0"+u),1==c.length&&(c="0"+c),"#"+f+u+c}function P(e){var a=i.find("canvas#progress");if(e>0){0===a.length&&(a=t("<canvas>").attr({id:"progress"}).appendTo(n));var o=a[0];if(o){o.height=n.height(),o.width=n.width();var r=o.width/2,s=o.height/2;if(o.getContext){var l=o.getContext("2d");l.beginPath(),l.strokeStyle=v.onColor,l.arc(r,s,r*(-.4/90*Number(v.progressWidth)+.8),-.5*Math.PI,(-.5+2*e)*Math.PI,!1),l.lineWidth=.8*r*v.progressWidth/100,l.stroke()}}}else i.find("canvas#progress").remove()}function T(){clearTimeout(r),u=c>0?u-=v.step:u+=v.step,u>v.max&&(u=v.max),u<v.min&&(u=v.min),D();var t=l[Math.abs(c)];r=setTimeout(function(){T()},500-t)}function D(){var t=o[0];if(t.height=n.innerHeight(),t.width=n.innerWidth(),t.getContext){var e=t.getContext("2d");e.strokeStyle=v.offBackgroundColor;for(var i=v.max,r=v.min,s=t.height-Math.round(t.height*(u-r)/(i-r)),l=0;l<t.height;l+=4)e.lineWidth=1,e.beginPath(),e.moveTo(5,l),e.lineTo(25,l),e.stroke();e.strokeStyle=a?v.onBackgroundColor:x(v.offBackgroundColor,"#ffffff",.4),e.lineWidth=3,e.beginPath(),e.moveTo(5,s),e.lineTo(25,s),e.stroke(),e.fillStyle=x(v.offBackgroundColor,"#ffffff",.4),e.font="10px sans-serif",e.fillText(u,30,t.height)}}function k(){o.css({position:"absolute","z-index":-1}),h?o.animate({left:.6*-n.innerWidth()+"px"}):o.animate({left:n.innerWidth()/5+"px",top:"0px"})}function I(t){t=(t||navigator.userAgent).toLowerCase();var e=t.match(/android\s([0-9\.]*)/);return e?e[1]:!1}function M(){var e,l,E,d=I(),m=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,b=d&&parseFloat(d)<5||m,S=b?"touchstart":"touchstart mousedown",x=b?"touchmove":"touchmove mousemove",P=b?"touchend":"touchend mouseup",M=b?"touchleave":"touchleave mouseout";"push"==v.mode?(n.on(S,function(i){i.stopImmediatePropagation(),l=t(window).scrollTop(),e=t(window).scrollLeft()}),n.on(P,function(n){return n.preventDefault(),n.stopImmediatePropagation(),Math.abs(l-t(window).scrollTop())>3||Math.abs(e-t(window).scrollLeft())>3?void 0:(E=a,w(),"function"==typeof v.toggleOn&&v.toggleOn.call(this),setTimeout(function(){y()},200),E===!0&&setTimeout(function(){w()},1e3),setTimeout(function(){a===!0&&w()},1200),i.trigger("clicked"),!1)})):"updown"==v.mode?(n.on(S,function(t){t.preventDefault(),t.stopImmediatePropagation(),E=a,w(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)}),n.on(P,function(t){return t.preventDefault(),t.stopImmediatePropagation(),"function"==typeof v.toggleOff&&v.toggleOff.call(this),setTimeout(function(){y()},200),E===!0&&setTimeout(function(){w()},1e3),setTimeout(function(){a===!0&&w()},1200),i.trigger("clicked"),!1})):"toggle"==v.mode?(n.on(S,function(i){i.stopImmediatePropagation(),l=t(window).scrollTop(),e=t(window).scrollLeft()}),n.on(P,function(n){return n.preventDefault(),n.stopImmediatePropagation(),Math.abs(l-t(window).scrollTop())>3||Math.abs(e-t(window).scrollLeft())>3?void 0:(a?($(),"function"==typeof v.toggleOff&&v.toggleOff.call(this)):(w(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)),i.trigger("clicked"),!1)})):"dimmer"==v.mode&&(n.on(S,function(t){t.preventDefault(),t.stopImmediatePropagation();var e=t.originalEvent;f=e.touches?e.touches[0].clientY:t.pageY,c=0,p=!0}),n.on(M,function(t){t.preventDefault(),t.stopImmediatePropagation(),h&&(h=!1,n.animate({top:0}),clearInterval(r),s=!1,k()),p=!1}),n.on(P,function(t){return t.preventDefault(),t.stopImmediatePropagation(),h?(h=!1,n.animate({top:0}),clearTimeout(r),s=!1,"function"==typeof v.valueChanged&&v.valueChanged.call(this,u)):a?($(),"function"==typeof v.toggleOff&&v.toggleOff.call(this)):(w(),"function"==typeof v.toggleOn&&v.toggleOn.call(this)),h=!1,p=!1,k(),D(),i.trigger("clicked"),!1}),n.on(x,function(t){t.preventDefault(),t.stopImmediatePropagation(),p&&(h=!0);var e=t.originalEvent;if(g=e.touches?e.touches[0].clientY:t.pageY,c=g-f,c>20&&(c=20),-20>c&&(c=-20),h){this.style.top=c+"px";var i=o[0];i.style.top=-c+"px",s||(k(),T(),s=!0)}}))}if(this.length>1)return this.each(function(){t(this).famultibutton(e)}),this;var n,o,r,i=this,a=!1,s=!1,l=[0,10,40,80,120,140,150,160,180,200,240,260,280,300,320,420,430,440,450,460,470],f=0,u=0,c=0,d=0,g=0,h=!1,p=!1,m={backgroundIcon:"fa-circle",classes:["fa-2x"],icon:"fa-power-off",offColor:"#2A2A2A",offBackgroundColor:"#505050",onColor:"#2A2A2A",onBackgroundColor:"#aa6900",mode:"toggle",toggleOn:null,toggleOff:null,valueChanged:null,progressWidth:15,max:100,min:0,step:1},v=t.extend({},m,e),b=function(){v=t.extend({},v,i.data());var e=i.html()!==i.text()?jQuery("<div>",{}).html(i.html()).children().detach():jQuery("<div>",{}).text(i.text());if("none"!==v.onColor&&"none"!==v.offColor&&e.attr("id","fg"),e.addClass("fa-stack-1x"),i.html(""),n=t("<div/>",{"class":"famultibutton"}).appendTo(i),n.addClass("fa-stack"),jQuery("<i/>",{id:"bg","class":"fa fa-stack-2x"}).addClass(v.backgroundIcon).appendTo(n),jQuery("<i/>",{id:"fg","class":"fa fa-stack-1x"}).addClass(v.icon).appendTo(n),e.appendTo(n),v.classes&&v.classes.length>0)for(var a=0;a<v.classes.length;a++)n.addClass(v.classes[a]);return i.o=v,$(),"dimmer"==v.mode&&(o=t("<canvas>").attr({id:"scale",height:i.height()+"px",width:i.width()+"px"}).appendTo(n),d=parseInt(o.offset().top)-parseInt(n.offset().top),D(),k()),i.data("famultibutton",i),M(),i};return this.setOn=function(){w()},this.setOff=function(){$()},this.getState=function(){return a},this.getValue=function(){return u},this.setDimValue=function(t){u=t,D()},this.setProgressValue=function(t){P(t)},b()}}(jQuery);